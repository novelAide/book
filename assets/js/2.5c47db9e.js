(window.webpackJsonp=window.webpackJsonp||[]).push([[2,14,50],{682:function(e,t,i){},690:function(e,t,i){e.exports=i.p+"assets/img/003.80bf44f7.jpg"},691:function(e,t,i){e.exports=i.p+"assets/img/004.69b98c1e.jpg"},692:function(e,t,i){e.exports=i.p+"assets/img/005.cd07e74b.jpg"},693:function(e,t,i){e.exports=i.p+"assets/img/001.0366e188.jpg"},694:function(e,t,i){e.exports=i.p+"assets/img/002.ebd5f63f.jpg"},695:function(e,t,i){e.exports=i.p+"assets/img/006.240c3488.jpg"},696:function(e,t,i){e.exports=i.p+"assets/img/007.c4887518.jpg"},697:function(e,t,i){e.exports=i.p+"assets/img/008.50e179c4.jpg"},698:function(e,t,i){"use strict";i(682)},715:function(e,t){
/**
 * @license BSD
 * @copyright 2014-2022 hizzgdev@163.com
 * 
 * Project Home:
 *   https://github.com/hizzgdev/jsmind/
 */
!function(e){"use strict";var t=e.document,i=e.jsMind;if(i&&void 0===i.draggable){var n=i.util.dom,o="getSelection"in e?function(){e.getSelection().removeAllRanges()}:function(){t.selection.empty()},a=5,s=500,d=80;i.draggable=function(e){this.jm=e,this.e_canvas=null,this.canvas_ctx=null,this.shadow=null,this.shadow_w=0,this.shadow_h=0,this.active_node=null,this.target_node=null,this.target_direct=null,this.client_w=0,this.client_h=0,this.offset_x=0,this.offset_y=0,this.hlookup_delay=0,this.hlookup_timer=0,this.capture=!1,this.moved=!1},i.draggable.prototype={init:function(){this._create_canvas(),this._create_shadow(),this._event_bind()},resize:function(){this.jm.view.e_nodes.appendChild(this.shadow),this.e_canvas.width=this.jm.view.size.w,this.e_canvas.height=this.jm.view.size.h},_create_canvas:function(){var e=t.createElement("canvas");this.jm.view.e_panel.appendChild(e);var i=e.getContext("2d");this.e_canvas=e,this.canvas_ctx=i},_create_shadow:function(){var e=t.createElement("jmnode");e.style.visibility="hidden",e.style.zIndex="3",e.style.cursor="move",e.style.opacity="0.7",this.shadow=e},reset_shadow:function(e){var t=this.shadow.style;this.shadow.innerHTML=e.innerHTML,t.left=e.style.left,t.top=e.style.top,t.width=e.style.width,t.height=e.style.height,t.backgroundImage=e.style.backgroundImage,t.backgroundSize=e.style.backgroundSize,t.transform=e.style.transform,this.shadow_w=this.shadow.clientWidth,this.shadow_h=this.shadow.clientHeight},show_shadow:function(){this.moved||(this.shadow.style.visibility="visible")},hide_shadow:function(){this.shadow.style.visibility="hidden"},_magnet_shadow:function(e){e&&(this.canvas_ctx.lineWidth=a,this.canvas_ctx.strokeStyle="rgba(0,0,0,0.3)",this.canvas_ctx.lineCap="round",this._clear_lines(),this._canvas_lineto(e.sp.x,e.sp.y,e.np.x,e.np.y))},_clear_lines:function(){this.canvas_ctx.clearRect(0,0,this.jm.view.size.w,this.jm.view.size.h)},_canvas_lineto:function(e,t,i,n){this.canvas_ctx.beginPath(),this.canvas_ctx.moveTo(e,t),this.canvas_ctx.lineTo(i,n),this.canvas_ctx.stroke()},_lookup_close_node:function(){var e,t,n=this.jm.get_root(),o=n.get_location(),s=n.get_size(),d=o.x+s.w/2,r=this.shadow_w,l=this.shadow_h,h=this.shadow.offsetLeft,_=this.shadow.offsetTop,c=h+r/2>=d?i.direction.right:i.direction.left,u=this.jm.mind.nodes,f=null,v=this.jm.layout,p=Number.MAX_VALUE,m=0,g=null,y=null,w=null;for(var b in u){var x,j;if((f=u[b]).isroot||f.direction==c){if(f.id==this.active_node.id)continue;if(!v.is_visible(f))continue;if(e=f.get_size(),t=f.get_location(),c==i.direction.right){if(h-t.x-e.w<=0)continue;m=Math.abs(h-t.x-e.w)+Math.abs(_+l/2-t.y-e.h/2),x={x:t.x+e.w-a,y:t.y+e.h/2},j={x:h+a,y:_+l/2}}else{if(t.x-h-r<=0)continue;m=Math.abs(h+r-t.x)+Math.abs(_+l/2-t.y-e.h/2),x={x:t.x+a,y:t.y+e.h/2},j={x:h+r-a,y:_+l/2}}m<p&&(g=f,y=x,w=j,p=m)}}var k=null;return g&&(k={node:g,direction:c,sp:w,np:y}),k},lookup_close_node:function(){var e=this._lookup_close_node();e&&(this._magnet_shadow(e),this.target_node=e.node,this.target_direct=e.direction)},_event_bind:function(){var e=this,t=this.jm.view.container;n.add_event(t,"mousedown",(function(t){var i=t||event;e.dragstart.call(e,i)})),n.add_event(t,"mousemove",(function(t){var i=t||event;e.drag.call(e,i)})),n.add_event(t,"mouseup",(function(t){var i=t||event;e.dragend.call(e,i)})),n.add_event(t,"touchstart",(function(t){var i=t||event;e.dragstart.call(e,i)})),n.add_event(t,"touchmove",(function(t){var i=t||event;e.drag.call(e,i)})),n.add_event(t,"touchend",(function(t){var i=t||event;e.dragend.call(e,i)}))},dragstart:function(t){if(this.jm.get_editable()&&!this.capture){this.active_node=null;var i=this.jm.view,n=t.target||event.srcElement;if("jmnode"==n.tagName.toLowerCase()){i.get_draggable_canvas()&&i.disable_draggable_canvas();var o=i.get_binded_nodeid(n);if(o){var a=this.jm.get_node(o);if(!a.isroot){this.reset_shadow(n),this.active_node=a,this.offset_x=(t.clientX||t.touches[0].clientX)/i.actualZoom-n.offsetLeft,this.offset_y=(t.clientY||t.touches[0].clientY)/i.actualZoom-n.offsetTop,this.client_hw=Math.floor(n.clientWidth/2),this.client_hh=Math.floor(n.clientHeight/2),0!=this.hlookup_delay&&e.clearTimeout(this.hlookup_delay),0!=this.hlookup_timer&&e.clearInterval(this.hlookup_timer);var r=this;this.hlookup_delay=e.setTimeout((function(){r.hlookup_delay=0,r.hlookup_timer=e.setInterval((function(){r.lookup_close_node.call(r)}),d)}),s),this.capture=!0}}}}},drag:function(e){if(this.jm.get_editable()&&this.capture){e.preventDefault(),this.show_shadow(),this.moved=!0,o();var t=this.jm.view,i=(e.clientX||e.touches[0].clientX)/t.actualZoom-this.offset_x,n=(e.clientY||e.touches[0].clientY)/t.actualZoom-this.offset_y;this.shadow.style.left=i+"px",this.shadow.style.top=n+"px",o()}},dragend:function(t){if(this.jm.get_editable()){if(this.jm.view.get_draggable_canvas()&&this.jm.view.enable_draggable_canvas(),this.capture){if(0!=this.hlookup_delay&&(e.clearTimeout(this.hlookup_delay),this.hlookup_delay=0,this._clear_lines()),0!=this.hlookup_timer&&(e.clearInterval(this.hlookup_timer),this.hlookup_timer=0,this._clear_lines()),this.moved){var i=this.active_node,n=this.target_node,o=this.target_direct;this.move_node(i,n,o)}this.hide_shadow()}this.moved=!1,this.capture=!1}},move_node:function(e,t,n){var o=this.shadow.offsetTop;if(t&&e&&!i.node.inherited(e,t)){for(var a=t.children,s=a.length,d=null,r=Number.MAX_VALUE,l=null,h="_last_";s--;)if((d=a[s]).direction==n&&d.id!=e.id){var _=d.get_location().y-o;_>0&&_<r&&(r=_,l=d,h="_first_")}l&&(h=l.id),this.jm.move_node(e.id,h,t.id,n)}this.active_node=null,this.target_node=null,this.target_direct=null},jm_event_handle:function(e,t){e===i.event_type.resize&&this.resize()}};var r=new i.plugin("draggable",(function(e){var t=new i.draggable(e);t.init(),e.add_event_listener((function(e,i){t.jm_event_handle.call(t,e,i)}))}));i.register_plugin(r)}}(window)},716:function(e,t,i){},717:function(e,t,i){},718:function(e,t,i){},744:function(e,t,i){"use strict";i.r(t);var n=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"content"},[t("h2",[e._v("小说大纲工具使用文档")]),e._v(" "),t("h3",[e._v("一、简述")]),e._v(" "),t("div",{staticClass:"ligh"},[e._v("\n      ㅤㅤㅤ大纲工具可以很好的为小说大纲进行模块化的梳理，支持一键导入、新建、另存、截图等功能。值得一提的是，这些数据可以直接存储在写手自己的计算机，不上传到平台服务器，有效保护作品信息。同时，本工具目前拥有16个color主题，以供于使用，后续会逐渐进行更加完美的优化。\n    ")]),e._v(" "),t("h3",[e._v("二、使用方法之文件操作")]),e._v(" "),t("div",{staticClass:"ligh"},[e._v("\n      ㅤㅤㅤ 1、刚进入大纲工具处于以下默认模板，在没有新建和另存的情况下，直接操作默认模板的节点不会保存。\n      "),t("img",{attrs:{src:i(690)}}),e._v("\n      ㅤㅤㅤ 2、所以进入大纲工具首先要另存或者新建一份文件到自己的笔记本上，然后对节点每次操作都会自动存储到你的笔记本上。新建或者另存的文件格式是jm格式，使用的时候直接导入即可。\n      "),t("div",[t("img",{staticStyle:{margin:"30px 0 30px 26%",width:"50%"},attrs:{src:i(691)}})]),e._v("\n      ㅤㅤㅤ 3、导入文件，必须是jm格式，没有的话直接另存一份就可以。导入会有一个浏览器默认提示弹层，点击保存更改即可。\n      "),t("div",[t("img",{staticStyle:{margin:"30px",width:"90%"},attrs:{src:i(692)}})])]),e._v(" "),t("h3",[e._v("三、使用方法之节点操作")]),e._v(" "),t("div",{staticClass:"ligh"},[e._v("\n      ㅤㅤㅤ 1、点击选择节点，右击鼠标，唤醒菜单，对节点进行操作。\n      "),t("img",{attrs:{src:i(693)}}),e._v(" "),t("img",{attrs:{src:i(694)}}),e._v("\n      ㅤㅤㅤ 2、双击节点，对节点进行编辑。"),t("br"),e._v("\n      ㅤㅤㅤ 3、使用快捷键对节点进行操作(首先选中操作节点，接下来使用快捷键进行操作)"),t("br"),e._v("\n      ㅤㅤㅤㅤㅤㅤㅤ - Tab => 新增子节点"),t("br"),e._v("\n      ㅤㅤㅤㅤㅤㅤㅤ - Enter => 新增兄弟节点"),t("br"),e._v("\n      ㅤㅤㅤㅤㅤㅤㅤ - F2 => 编辑当前节点"),t("br"),e._v("\n      ㅤㅤㅤㅤㅤㅤㅤ - BackSpace => 删除选中节点"),t("br"),e._v("\n      ㅤㅤㅤㅤㅤㅤㅤ - Left => 向左选择节点"),t("br"),e._v("\n      ㅤㅤㅤㅤㅤㅤㅤ - Up => 向上选择节点"),t("br"),e._v("\n      ㅤㅤㅤㅤㅤㅤㅤ - Right => 向右选择节点"),t("br"),e._v("\n      ㅤㅤㅤㅤㅤㅤㅤ - Down => 向下选择节点"),t("br"),e._v("\n      ㅤㅤㅤㅤㅤㅤㅤ - 注意：点击Tab和Enter新增节点后，节点输入框处于聚焦状态，继续新增需要回车。"),t("br")]),e._v(" "),t("h3",[e._v("四、拖拽缩放及其他")]),e._v(" "),t("div",{staticClass:"ligh"},[e._v("\n      ㅤㅤㅤ 1、点击右下角第一个“详”字，进入大纲操作学习文档。"),t("br"),e._v("\n      ㅤㅤㅤ 2、点击右下角第一个“-”或者“+”，前者是缩小，后者是放大。"),t("br"),e._v("\n      ㅤㅤㅤ 4、当节点在水平或者垂直方向放不下，或者放大节点，这个时候可以拖拽。"),t("br")]),e._v(" "),t("h3",[e._v("五、其他主题（这里展示3个示例）")]),e._v(" "),t("img",{attrs:{src:i(695)}}),e._v(" "),t("img",{attrs:{src:i(696)}}),e._v(" "),t("img",{attrs:{src:i(697)}}),e._v(" "),t("h3",[e._v("六、加入交流群")]),e._v(" "),t("div",{staticClass:"ligh"},[e._v("\n      ㅤㅤㅤ 1、交流群最主要的目的是防网站失联，以及网站优化建议"),t("br"),e._v("\n      ㅤㅤㅤ 2、小说学习交流"),t("br"),e._v("\n      ㅤㅤㅤ 4、网文世界交流2群：498109650"),t("br"),e._v("\n      ㅤㅤㅤ 5、网文世界交流3群：566164456"),t("br"),e._v("\n      ㅤㅤㅤ 6、合作qq：1347177399\n    ")]),e._v(" "),t("div",{staticStyle:{width:"100%",height:"150px"}})])}],o={methods:{hBack(){this.$emit("change")}}},a=(i(698),i(46)),s=Object(a.a)(o,(function(){var e=this._self._c;return e("div",{staticClass:"useCon"},[e("el-tooltip",{attrs:{effect:"dark",content:"开始使用大纲工具！",placement:"top-start"}},[e("div",{staticClass:"change",on:{click:this.hBack}},[e("i",{staticClass:"xmindChange"})])]),this._v(" "),this._m(0)],1)}),n,!1,null,"81377cfe",null);t.default=s.exports},776:function(e,t,i){},777:function(e,t,i){!function(t){"use strict";var i=function(){},n="undefined"==typeof console?{log:i,debug:i,error:i,warn:i,info:i}:console;if(e.exports||void 0===t.jsMind){var o=t.document,a=function(e){return o.createElement(e)},s=function(e,t){e.hasChildNodes()?e.firstChild.nodeValue=t:e.appendChild(o.createTextNode(t))},d=function(e,t){t instanceof HTMLElement?(e.innerHTML="",e.appendChild(t)):e.innerHTML=t};"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return this.slice(0,e.length)===e});var r={container:"",editable:!1,theme:null,mode:"full",support_html:!0,view:{engine:"canvas",hmargin:100,vmargin:50,line_width:2,line_color:"#555",draggable:!1,hide_scrollbars_when_draggable:!1},layout:{hspace:30,vspace:20,pspace:13},default_event_handle:{enable_mousedown_handle:!0,enable_click_handle:!0,enable_dblclick_handle:!0,enable_mousewheel_handle:!0},shortcut:{enable:!0,handles:{},mapping:{addchild:45,addbrother:13,editnode:113,delnode:46,toggle:32,left:37,up:38,right:39,down:40}}},l=function(e){l.current=this,this.version="0.4.12";var t={};l.util.json.merge(t,r),l.util.json.merge(t,e),t.container?(this.options=t,this.initialized=!1,this.mind=null,this.event_handles=[],this.init()):n.error("the options.container should not be null or empty.")};l.direction={left:-1,center:0,right:1},l.event_type={show:1,resize:2,edit:3,select:4},l.key={meta:8192,ctrl:4096,alt:2048,shift:1024},l.node=function(e,t,i,o,a,s,d,r){e?"number"==typeof t?(void 0===r&&(r=!0),this.id=e,this.index=t,this.topic=i,this.data=o||{},this.isroot=a,this.parent=s,this.direction=d,this.expanded=!!r,this.children=[],this._data={}):n.error("invalid node index"):n.error("invalid node id")},l.node.compare=function(e,t){var i=e.index,n=t.index;return i>=0&&n>=0?i-n:-1==i&&-1==n?0:-1==i?1:-1==n?-1:0},l.node.inherited=function(e,t){if(e&&t){if(e.id===t.id)return!0;if(e.isroot)return!0;for(var i=e.id,n=t;!n.isroot;)if((n=n.parent).id===i)return!0}return!1},l.node.is_node=function(e){return!!e&&e instanceof l.node},l.node.prototype={get_location:function(){var e=this._data.view;return{x:e.abs_x,y:e.abs_y}},get_size:function(){var e=this._data.view;return{w:e.width,h:e.height}}},l.mind=function(){this.name=null,this.author=null,this.version=null,this.root=null,this.selected=null,this.nodes={}},l.mind.prototype={get_node:function(e){return e in this.nodes?this.nodes[e]:(n.warn("the node[id="+e+"] can not be found"),null)},set_root:function(e,t,i){return null==this.root?(this.root=new l.node(e,0,t,i,!0),this._put_node(this.root),this.root):(n.error("root node is already exist"),null)},add_node:function(e,t,i,o,a,s,d){if(!l.util.is_node(e))return n.error("the parent_node "+e+" is not a node."),null;var r=d||-1,h=new l.node(t,r,i,o,!1,e,e.direction,s);return e.isroot&&(h.direction=a||l.direction.right),this._put_node(h)?(e.children.push(h),this._reindex(e)):(n.error("fail, the nodeid '"+h.id+"' has been already exist."),h=null),h},insert_node_before:function(e,t,i,o,a){if(!l.util.is_node(e))return n.error("the node_before "+e+" is not a node."),null;var s=e.index-.5;return this.add_node(e.parent,t,i,o,a,!0,s)},get_node_before:function(e){if(!l.util.is_node(e)){var t=this.get_node(e);return t?this.get_node_before(t):(n.error("the node[id="+e+"] can not be found."),null)}if(e.isroot)return null;var i=e.index-2;return i>=0?e.parent.children[i]:null},insert_node_after:function(e,t,i,o,a){if(!l.util.is_node(e))return n.error("the node_after "+e+" is not a node."),null;var s=e.index+.5;return this.add_node(e.parent,t,i,o,a,!0,s)},get_node_after:function(e){if(!l.util.is_node(e)){var t=this.get_node(e);return t?this.get_node_after(t):(n.error("the node[id="+e+"] can not be found."),null)}if(e.isroot)return null;var i=e.index;return e.parent.children.length>i?e.parent.children[i]:null},move_node:function(e,t,i,o){return l.util.is_node(e)?(i||(i=e.parent.id),this._move_node(e,t,i,o)):(n.error("the parameter node "+e+" is not a node."),null)},_flow_node_direction:function(e,t){void 0===t?t=e.direction:e.direction=t;for(var i=e.children.length;i--;)this._flow_node_direction(e.children[i],t)},_move_node_internal:function(e,t){if(e&&t)if("_last_"==t)e.index=-1,this._reindex(e.parent);else if("_first_"==t)e.index=0,this._reindex(e.parent);else{var i=t?this.get_node(t):null;null!=i&&null!=i.parent&&i.parent.id==e.parent.id&&(e.index=i.index-.5,this._reindex(e.parent))}return e},_move_node:function(e,t,i,o){if(e&&i){var a=this.get_node(i);if(l.node.inherited(e,a))return n.error("can not move a node to its children"),null;if(e.parent.id!=i){for(var s=e.parent.children,d=s.length;d--;)if(s[d].id==e.id){s.splice(d,1);break}e.parent=a,a.children.push(e)}e.parent.isroot?o==l.direction.left?e.direction=o:e.direction=l.direction.right:e.direction=e.parent.direction,this._move_node_internal(e,t),this._flow_node_direction(e)}return e},remove_node:function(e){if(!l.util.is_node(e))return n.error("the parameter node "+e+" is not a node."),!1;if(e.isroot)return n.error("fail, can not remove root node"),!1;null!=this.selected&&this.selected.id==e.id&&(this.selected=null);for(var t=e.children,i=t.length;i--;)this.remove_node(t[i]);t.length=0;for(var o=e.parent.children,a=o.length;a--;)if(o[a].id==e.id){o.splice(a,1);break}for(var s in delete this.nodes[e.id],e)delete e[s];return e=null,!0},_put_node:function(e){return e.id in this.nodes?(n.warn("the nodeid '"+e.id+"' has been already exist."),!1):(this.nodes[e.id]=e,!0)},_reindex:function(e){if(e instanceof l.node){e.children.sort(l.node.compare);for(var t=0;t<e.children.length;t++)e.children[t].index=t+1}}},l.format={node_tree:{example:{meta:{name:"jsMind",author:"hizzgdev@163.com",version:"0.4.12"},format:"node_tree",data:{id:"root",topic:"jsMind Example"}},get_mind:function(e){var t=l.format.node_tree,i=new l.mind;return i.name=e.meta.name,i.author=e.meta.author,i.version=e.meta.version,t._parse(i,e.data),i},get_data:function(e){var t=l.format.node_tree,i={};return i.meta={name:e.name,author:e.author,version:e.version},i.format="node_tree",i.data=t._buildnode(e.root),i},_parse:function(e,t){var i=l.format.node_tree,n=i._extract_data(t);if(e.set_root(t.id,t.topic,n),"children"in t)for(var o=t.children,a=0;a<o.length;a++)i._extract_subnode(e,e.root,o[a])},_extract_data:function(e){var t={};for(var i in e)"id"!=i&&"topic"!=i&&"children"!=i&&"direction"!=i&&"expanded"!=i&&(t[i]=e[i]);return t},_extract_subnode:function(e,t,i){var n=l.format.node_tree,o=n._extract_data(i),a=null;t.isroot&&(a="left"==i.direction?l.direction.left:l.direction.right);var s=e.add_node(t,i.id,i.topic,o,a,i.expanded);if(i.children)for(var d=i.children,r=0;r<d.length;r++)n._extract_subnode(e,s,d[r])},_buildnode:function(e){var t=l.format.node_tree;if(e instanceof l.node){var i={id:e.id,topic:e.topic,expanded:e.expanded};if(e.parent&&e.parent.isroot&&(i.direction=e.direction==l.direction.left?"left":"right"),null!=e.data){var n=e.data;for(var o in n)i[o]=n[o]}var a=e.children;if(a.length>0){i.children=[];for(var s=0;s<a.length;s++)i.children.push(t._buildnode(a[s]))}return i}}},node_array:{example:{meta:{name:"jsMind",author:"hizzgdev@163.com",version:"0.4.12"},format:"node_array",data:[{id:"root",topic:"jsMind Example",isroot:!0}]},get_mind:function(e){var t=l.format.node_array,i=new l.mind;return i.name=e.meta.name,i.author=e.meta.author,i.version=e.meta.version,t._parse(i,e.data),i},get_data:function(e){var t=l.format.node_array,i={};return i.meta={name:e.name,author:e.author,version:e.version},i.format="node_array",i.data=[],t._array(e,i.data),i},_parse:function(e,t){var i=l.format.node_array,o=t.slice(0);o.reverse();var a=i._extract_root(e,o);a?i._extract_subnode(e,a,o):n.error("root node can not be found")},_extract_root:function(e,t){for(var i=l.format.node_array,n=t.length;n--;)if("isroot"in t[n]&&t[n].isroot){var o=t[n],a=i._extract_data(o),s=e.set_root(o.id,o.topic,a);return t.splice(n,1),s}return null},_extract_subnode:function(e,t,i){for(var n=l.format.node_array,o=i.length,a=null,s=null,d=0;o--;)if((a=i[o]).parentid==t.id){s=n._extract_data(a);var r=null,h=a.direction;h&&(r="left"==h?l.direction.left:l.direction.right);var _=e.add_node(t,a.id,a.topic,s,r,a.expanded);i.splice(o,1),d++;var c=n._extract_subnode(e,_,i);c>0&&(o=i.length,d+=c)}return d},_extract_data:function(e){var t={};for(var i in e)"id"!=i&&"topic"!=i&&"parentid"!=i&&"isroot"!=i&&"direction"!=i&&"expanded"!=i&&(t[i]=e[i]);return t},_array:function(e,t){l.format.node_array._array_node(e.root,t)},_array_node:function(e,t){var i=l.format.node_array;if(e instanceof l.node){var n={id:e.id,topic:e.topic,expanded:e.expanded};if(e.parent&&(n.parentid=e.parent.id),e.isroot&&(n.isroot=!0),e.parent&&e.parent.isroot&&(n.direction=e.direction==l.direction.left?"left":"right"),null!=e.data){var o=e.data;for(var a in o)n[a]=o[a]}t.push(n);for(var s=e.children.length,d=0;d<s;d++)i._array_node(e.children[d],t)}}},freemind:{example:{meta:{name:"jsMind",author:"hizzgdev@163.com",version:"0.4.12"},format:"freemind",data:'<map version="1.0.1"><node ID="root" TEXT="freemind Example"/></map>'},get_mind:function(e){var t=l.format.freemind,i=new l.mind;i.name=e.meta.name,i.author=e.meta.author,i.version=e.meta.version;var n=e.data,o=t._parse_xml(n),a=t._find_root(o);return t._load_node(i,null,a),i},get_data:function(e){var t=l.format.freemind,i={};i.meta={name:e.name,author:e.author,version:e.version},i.format="freemind";var n=[];return n.push('<map version="1.0.1">'),t._buildmap(e.root,n),n.push("</map>"),i.data=n.join(" "),i},_parse_xml:function(e){var t=null;window.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e));return t},_find_root:function(e){for(var t=e.childNodes,i=null,n=null,o=0;o<t.length;o++)if(1==(n=t[o]).nodeType&&"map"==n.tagName){i=n;break}if(i){var a=i.childNodes;i=null;for(o=0;o<a.length;o++)if(1==(n=a[o]).nodeType&&"node"==n.tagName){i=n;break}}return i},_load_node:function(e,t,i){var n=l.format.freemind,o=i.getAttribute("ID"),a=i.getAttribute("TEXT");if(null==a)for(var s=i.childNodes,d=null,r=0;r<s.length;r++)if(1==(d=s[r]).nodeType&&"richcontent"===d.tagName){a=d.textContent;break}var h=n._load_attributes(i),_=!("expanded"in h)||"true"==h.expanded;delete h.expanded;var c=i.getAttribute("POSITION"),u=null;c&&(u="left"==c?l.direction.left:l.direction.right);var f=null;f=t?e.add_node(t,o,a,h,u,_):e.set_root(o,a,h);var v=i.childNodes,p=null;for(r=0;r<v.length;r++)1==(p=v[r]).nodeType&&"node"==p.tagName&&n._load_node(e,f,p)},_load_attributes:function(e){for(var t=e.childNodes,i=null,n={},o=0;o<t.length;o++)1==(i=t[o]).nodeType&&"attribute"===i.tagName&&(n[i.getAttribute("NAME")]=i.getAttribute("VALUE"));return n},_buildmap:function(e,t){var i=l.format.freemind,n=null;e.parent&&e.parent.isroot&&(n=e.direction===l.direction.left?"left":"right"),t.push("<node"),t.push('ID="'+e.id+'"'),n&&t.push('POSITION="'+n+'"'),t.push('TEXT="'+e.topic+'">'),t.push('<attribute NAME="expanded" VALUE="'+e.expanded+'"/>');var o=e.data;if(null!=o)for(var a in o)t.push('<attribute NAME="'+a+'" VALUE="'+o[a]+'"/>');for(var s=e.children,d=0;d<s.length;d++)i._buildmap(s[d],t);t.push("</node>")}}},l.util={is_node:function(e){return!!e&&e instanceof l.node},ajax:{request:function(e,t,i,o,a){l.util.ajax;var s=null,d=[];for(var r in t)d.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));d.length>0&&(s=d.join("&"));var h=new XMLHttpRequest;h&&(h.onreadystatechange=function(){if(4==h.readyState)if(200==h.status||0==h.status){if("function"==typeof o){var e=l.util.json.string2json(h.responseText);o(null!=e?e:h.responseText)}}else"function"==typeof a?a(h):n.error("xhr request failed.",h)},i=i||"GET",h.open(i,e,!0),h.setRequestHeader("If-Modified-Since","0"),"POST"==i?(h.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),h.send(s)):h.send())},get:function(e,t){return l.util.ajax.request(e,{},"GET",t)},post:function(e,t,i){return l.util.ajax.request(e,t,"POST",i)}},dom:{add_event:function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)}},file:{read:function(e,t){var i=new FileReader;i.onload=function(){"function"==typeof t&&t(this.result,e.name)},i.readAsText(e)},save:function(e,i,n){var s;if("function"==typeof t.Blob)s=new Blob([e],{type:i});else{var d=new(t.BlobBuilder||t.MozBlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder);d.append(e),s=d.getBlob(i)}if(navigator.msSaveBlob)navigator.msSaveBlob(s,n);else{var r=(t.URL||t.webkitURL).createObjectURL(s),l=a("a");if("download"in l){l.style.visibility="hidden",l.href=r,l.download=n,o.body.appendChild(l);var h=o.createEvent("MouseEvents");h.initEvent("click",!0,!0),l.dispatchEvent(h),o.body.removeChild(l)}else location.href=r}}},json:{json2string:function(e){return JSON.stringify(e)},string2json:function(e){return JSON.parse(e)},merge:function(e,t){for(var i in t)i in e?"object"!=typeof e[i]||"[object object]"!=Object.prototype.toString.call(e[i]).toLowerCase()||e[i].length?e[i]=t[i]:l.util.json.merge(e[i],t[i]):e[i]=t[i];return e}},uuid:{newid:function(){return((new Date).getTime().toString(16)+Math.random().toString(16).substring(2)).substring(2,18)}},text:{is_empty:function(e){return!e||0==e.replace(/\s*/,"").length}}},l.prototype={init:function(){if(!this.initialized){this.initialized=!0;var e=this.options,t={mode:e.mode,hspace:e.layout.hspace,vspace:e.layout.vspace,pspace:e.layout.pspace},i={container:e.container,support_html:e.support_html,engine:e.view.engine,hmargin:e.view.hmargin,vmargin:e.view.vmargin,line_width:e.view.line_width,line_color:e.view.line_color,draggable:e.view.draggable,hide_scrollbars_when_draggable:e.view.hide_scrollbars_when_draggable};this.data=new l.data_provider(this),this.layout=new l.layout_provider(this,t),this.view=new l.view_provider(this,i),this.shortcut=new l.shortcut_provider(this,e.shortcut),this.data.init(),this.layout.init(),this.view.init(),this.shortcut.init(),this._event_bind(),l.init_plugins(this)}},enable_edit:function(){this.options.editable=!0},disable_edit:function(){this.options.editable=!1},enable_event_handle:function(e){this.options.default_event_handle["enable_"+e+"_handle"]=!0},disable_event_handle:function(e){this.options.default_event_handle["enable_"+e+"_handle"]=!1},get_editable:function(){return this.options.editable},set_theme:function(e){var t=this.options.theme;this.options.theme=e||null,t!=this.options.theme&&(this.view.reset_theme(),this.view.reset_custom_style())},_event_bind:function(){this.view.add_event(this,"mousedown",this.mousedown_handle),this.view.add_event(this,"click",this.click_handle),this.view.add_event(this,"dblclick",this.dblclick_handle),this.view.add_event(this,"mousewheel",this.mousewheel_handle)},mousedown_handle:function(e){if(this.options.default_event_handle.enable_mousedown_handle){var t=e.target||event.srcElement,i=this.view.get_binded_nodeid(t);i?"jmnode"==t.tagName.toLowerCase()&&this.select_node(i):this.select_clear()}},click_handle:function(e){if(this.options.default_event_handle.enable_click_handle){var t=e.target||event.srcElement;if(this.view.is_expander(t)){var i=this.view.get_binded_nodeid(t);i&&this.toggle_node(i)}}},dblclick_handle:function(e){if(this.options.default_event_handle.enable_dblclick_handle&&this.get_editable()){var t=e.target||event.srcElement,i=this.view.get_binded_nodeid(t);i&&this.begin_edit(i)}},mousewheel_handle:function(e){this.options.default_event_handle.enable_mousewheel_handle&&window.event.ctrlKey&&(e.preventDefault(),e.deltaY<0?this.view.zoomIn():this.view.zoomOut())},begin_edit:function(e){if(!l.util.is_node(e)){var t=this.get_node(e);return t?this.begin_edit(t):(n.error("the node[id="+e+"] can not be found."),!1)}this.get_editable()?this.view.edit_node_begin(e):n.error("fail, this mind map is not editable.")},end_edit:function(){this.view.edit_node_end()},toggle_node:function(e){if(!l.util.is_node(e)){var t=this.get_node(e);return t?this.toggle_node(t):void n.error("the node[id="+e+"] can not be found.")}e.isroot||(this.view.save_location(e),this.layout.toggle_node(e),this.view.relayout(),this.view.restore_location(e))},expand_node:function(e){if(!l.util.is_node(e)){var t=this.get_node(e);return t?this.expand_node(t):void n.error("the node[id="+e+"] can not be found.")}e.isroot||(this.view.save_location(e),this.layout.expand_node(e),this.view.relayout(),this.view.restore_location(e))},collapse_node:function(e){if(!l.util.is_node(e)){var t=this.get_node(e);return t?this.collapse_node(t):void n.error("the node[id="+e+"] can not be found.")}e.isroot||(this.view.save_location(e),this.layout.collapse_node(e),this.view.relayout(),this.view.restore_location(e))},expand_all:function(){this.layout.expand_all(),this.view.relayout()},collapse_all:function(){this.layout.collapse_all(),this.view.relayout()},expand_to_depth:function(e){this.layout.expand_to_depth(e),this.view.relayout()},_reset:function(){this.view.reset(),this.layout.reset(),this.data.reset()},_show:function(e){var t=e||l.format.node_array.example;this.mind=this.data.load(t),this.mind?(n.debug("data.load ok"),this.view.load(),n.debug("view.load ok"),this.layout.layout(),n.debug("layout.layout ok"),this.view.show(!0),n.debug("view.show ok"),this.invoke_event_handle(l.event_type.show,{data:[e]})):n.error("data.load error")},show:function(e){this._reset(),this._show(e)},get_meta:function(){return{name:this.mind.name,author:this.mind.author,version:this.mind.version}},get_data:function(e){var t=e||"node_tree";return this.data.get_data(t)},get_root:function(){return this.mind.root},get_node:function(e){return l.util.is_node(e)?e:this.mind.get_node(e)},add_node:function(e,t,i,o){if(this.get_editable()){var a=this.get_node(e),s=this.layout.calculate_next_child_direction(a),d=this.mind.add_node(a,t,i,o,s);return d&&(this.view.add_node(d),this.layout.layout(),this.view.show(!1),this.view.reset_node_custom_style(d),this.expand_node(a),this.invoke_event_handle(l.event_type.edit,{evt:"add_node",data:[a.id,t,i,o],node:t})),d}return n.error("fail, this mind map is not editable"),null},insert_node_before:function(e,t,i,o){if(this.get_editable()){var a=this.get_node(e),s=this.layout.calculate_next_child_direction(a.parent),d=this.mind.insert_node_before(a,t,i,o,s);return d&&(this.view.add_node(d),this.layout.layout(),this.view.show(!1),this.invoke_event_handle(l.event_type.edit,{evt:"insert_node_before",data:[a.id,t,i,o],node:t})),d}return n.error("fail, this mind map is not editable"),null},insert_node_after:function(e,t,i,o){if(this.get_editable()){var a=this.get_node(e),s=this.layout.calculate_next_child_direction(a.parent),d=this.mind.insert_node_after(a,t,i,o,s);return d&&(this.view.add_node(d),this.layout.layout(),this.view.show(!1),this.invoke_event_handle(l.event_type.edit,{evt:"insert_node_after",data:[a.id,t,i,o],node:t})),d}return n.error("fail, this mind map is not editable"),null},remove_node:function(e){if(!l.util.is_node(e)){var t=this.get_node(e);return t?this.remove_node(t):(n.error("the node[id="+e+"] can not be found."),!1)}if(this.get_editable()){if(e.isroot)return n.error("fail, can not remove root node"),!1;var i=e.id,o=e.parent.id,a=this.get_node(o);return this.view.save_location(a),this.view.remove_node(e),this.mind.remove_node(e),this.layout.layout(),this.view.show(!1),this.view.restore_location(a),this.invoke_event_handle(l.event_type.edit,{evt:"remove_node",data:[i],node:o}),!0}return n.error("fail, this mind map is not editable"),!1},update_node:function(e,t){if(this.get_editable())if(l.util.text.is_empty(t))n.warn("fail, topic can not be empty");else{var i=this.get_node(e);if(i){if(i.topic===t)return n.info("nothing changed"),void this.view.update_node(i);i.topic=t,this.view.update_node(i),this.layout.layout(),this.view.show(!1),this.invoke_event_handle(l.event_type.edit,{evt:"update_node",data:[e,t],node:e})}}else n.error("fail, this mind map is not editable")},move_node:function(e,t,i,o){if(this.get_editable()){var a=this.get_node(e),s=this.mind.move_node(a,t,i,o);s&&(this.view.update_node(s),this.layout.layout(),this.view.show(!1),this.invoke_event_handle(l.event_type.edit,{evt:"move_node",data:[e,t,i,o],node:e}))}else n.error("fail, this mind map is not editable")},select_node:function(e){if(!l.util.is_node(e)){var t=this.get_node(e);return t?this.select_node(t):void n.error("the node[id="+e+"] can not be found.")}this.layout.is_visible(e)&&(this.mind.selected=e,this.view.select_node(e),this.invoke_event_handle(l.event_type.select,{evt:"select_node",data:[],node:e.id}))},get_selected_node:function(){return this.mind?this.mind.selected:null},select_clear:function(){this.mind&&(this.mind.selected=null,this.view.select_clear())},is_node_visible:function(e){return this.layout.is_visible(e)},find_node_before:function(e){if(!l.util.is_node(e)){var t=this.get_node(e);return t?this.find_node_before(t):void n.error("the node[id="+e+"] can not be found.")}if(e.isroot)return null;var i=null;if(e.parent.isroot)for(var o=e.parent.children,a=null,s=null,d=0;d<o.length;d++)s=o[d],e.direction===s.direction&&(e.id===s.id&&(i=a),a=s);else i=this.mind.get_node_before(e);return i},find_node_after:function(e){if(!l.util.is_node(e)){var t=this.get_node(e);return t?this.find_node_after(t):void n.error("the node[id="+e+"] can not be found.")}if(e.isroot)return null;var i=null;if(e.parent.isroot){for(var o=e.parent.children,a=!1,s=null,d=0;d<o.length;d++)if(s=o[d],e.direction===s.direction){if(a){i=s;break}e.id===s.id&&(a=!0)}}else i=this.mind.get_node_after(e);return i},set_node_color:function(e,t,i){if(!this.get_editable())return n.error("fail, this mind map is not editable"),null;var o=this.mind.get_node(e);o&&(t&&(o.data["background-color"]=t),i&&(o.data["foreground-color"]=i),this.view.reset_node_custom_style(o))},set_node_font_style:function(e,t,i,o){if(!this.get_editable())return n.error("fail, this mind map is not editable"),null;var a=this.mind.get_node(e);a&&(t&&(a.data["font-size"]=t),i&&(a.data["font-weight"]=i),o&&(a.data["font-style"]=o),this.view.reset_node_custom_style(a),this.view.update_node(a),this.layout.layout(),this.view.show(!1))},set_node_background_image:function(e,t,i,o,a){if(!this.get_editable())return n.error("fail, this mind map is not editable"),null;var s=this.mind.get_node(e);s&&(t&&(s.data["background-image"]=t),i&&(s.data.width=i),o&&(s.data.height=o),a&&(s.data["background-rotation"]=a),this.view.reset_node_custom_style(s),this.view.update_node(s),this.layout.layout(),this.view.show(!1))},set_node_background_rotation:function(e,t){if(!this.get_editable())return n.error("fail, this mind map is not editable"),null;var i=this.mind.get_node(e);if(i){if(!i.data["background-image"])return n.error("fail, only can change rotation angle of node with background image"),null;i.data["background-rotation"]=t,this.view.reset_node_custom_style(i),this.view.update_node(i),this.layout.layout(),this.view.show(!1)}},resize:function(){this.view.resize()},add_event_listener:function(e){"function"==typeof e&&this.event_handles.push(e)},clear_event_listener:function(){this.event_handles=[]},invoke_event_handle:function(e,i){var n=this;t.setTimeout((function(){n._invoke_event_handle(e,i)}),0)},_invoke_event_handle:function(e,t){for(var i=this.event_handles.length,n=0;n<i;n++)this.event_handles[n](e,t)}},l.data_provider=function(e){this.jm=e},l.data_provider.prototype={init:function(){n.debug("data.init")},reset:function(){n.debug("data.reset")},load:function(e){var t=null,i=null;return"node_array"==(t="object"==typeof e?e.format?e.format:"node_tree":"freemind")?i=l.format.node_array.get_mind(e):"node_tree"==t?i=l.format.node_tree.get_mind(e):"freemind"==t?i=l.format.freemind.get_mind(e):n.warn("unsupported format"),i},get_data:function(e){var t=null;return"node_array"==e?t=l.format.node_array.get_data(this.jm.mind):"node_tree"==e?t=l.format.node_tree.get_data(this.jm.mind):"freemind"==e?t=l.format.freemind.get_data(this.jm.mind):n.error("unsupported "+e+" format"),t}},l.layout_provider=function(e,t){this.opts=t,this.jm=e,this.isside="side"==this.opts.mode,this.bounds=null,this.cache_valid=!1},l.layout_provider.prototype={init:function(){n.debug("layout.init")},reset:function(){n.debug("layout.reset"),this.bounds={n:0,s:0,w:0,e:0}},calculate_next_child_direction:function(e){if(this.isside)return l.direction.right;for(var t=e.children||[],i=t.length,n=0,o=0;o<i;o++)t[o].direction===l.direction.left?n--:n++;return i>1&&n>0?l.direction.left:l.direction.right},layout:function(){n.debug("layout.layout"),this.layout_direction(),this.layout_offset()},layout_direction:function(){this._layout_direction_root()},_layout_direction_root:function(){var e=this.jm.mind.root,t=null;"layout"in e._data?t=e._data.layout:(t={},e._data.layout=t);var i=e.children,n=i.length;if(t.direction=l.direction.center,t.side_index=0,this.isside)for(var o=n;o--;)this._layout_direction_side(i[o],l.direction.right,o);else{o=n;for(var a=null;o--;)(a=i[o]).direction==l.direction.left?this._layout_direction_side(a,l.direction.left,o):this._layout_direction_side(a,l.direction.right,o)}},_layout_direction_side:function(e,t,i){var n=null;"layout"in e._data?n=e._data.layout:(n={},e._data.layout=n);var o=e.children,a=o.length;n.direction=t,n.side_index=i;for(var s=a;s--;)this._layout_direction_side(o[s],t,s)},layout_offset:function(){var e=this.jm.mind.root,t=e._data.layout;t.offset_x=0,t.offset_y=0,t.outer_height=0;for(var i=e.children,n=i.length,o=[],a=[],s=null;n--;)(s=i[n])._data.layout.direction==l.direction.right?a.unshift(s):o.unshift(s);t.left_nodes=o,t.right_nodes=a,t.outer_height_left=this._layout_offset_subnodes(o),t.outer_height_right=this._layout_offset_subnodes(a),this.bounds.e=e._data.view.width/2,this.bounds.w=0-this.bounds.e,this.bounds.n=0,this.bounds.s=Math.max(t.outer_height_left,t.outer_height_right)},_layout_offset_subnodes:function(e){for(var t=0,i=e.length,n=i,o=null,a=0,s=null,d=0,r=null;n--;)s=(o=e[n])._data.layout,null==r&&(r=o.parent._data),a=this._layout_offset_subnodes(o.children),o.expanded||(a=0,this.set_visible(o.children,!1)),a=Math.max(o._data.view.height,a),s.outer_height=a,s.offset_y=d-a/2,s.offset_x=this.opts.hspace*s.direction+r.view.width*(r.layout.direction+s.direction)/2,o.parent.isroot||(s.offset_x+=this.opts.pspace*s.direction),d=d-a-this.opts.vspace,t+=a;i>1&&(t+=this.opts.vspace*(i-1)),n=i;for(var l=t/2;n--;)(o=e[n])._data.layout.offset_y+=l;return t},_layout_offset_subnodes_height:function(e){for(var t=0,i=e.length,n=i,o=null,a=0,s=null,d=0,r=null;n--;)s=(o=e[n])._data.layout,null==r&&(r=o.parent._data),a=this._layout_offset_subnodes_height(o.children),o.expanded||(a=0),a=Math.max(o._data.view.height,a),s.outer_height=a,s.offset_y=d-a/2,d=d-a-this.opts.vspace,t+=a;i>1&&(t+=this.opts.vspace*(i-1)),n=i;for(var l=t/2;n--;)(o=e[n])._data.layout.offset_y+=l;return t},get_node_offset:function(e){var t=e._data.layout,i=null;if("_offset_"in t&&this.cache_valid?i=t._offset_:(i={x:-1,y:-1},t._offset_=i),-1==i.x||-1==i.y){var n=t.offset_x,o=t.offset_y;if(!e.isroot){var a=this.get_node_offset(e.parent);n+=a.x,o+=a.y}i.x=n,i.y=o}return i},get_node_point:function(e){var t=e._data.view,i=this.get_node_offset(e),n={};return n.x=i.x+t.width*(e._data.layout.direction-1)/2,n.y=i.y-t.height/2,n},get_node_point_in:function(e){return this.get_node_offset(e)},get_node_point_out:function(e){var t=e._data.layout,i=null;if("_pout_"in t&&this.cache_valid?i=t._pout_:(i={x:-1,y:-1},t._pout_=i),-1==i.x||-1==i.y)if(e.isroot)i.x=0,i.y=0;else{var n=e._data.view,o=this.get_node_offset(e);i.x=o.x+(n.width+this.opts.pspace)*e._data.layout.direction,i.y=o.y}return i},get_expander_point:function(e){var t=this.get_node_point_out(e),i={};return e._data.layout.direction==l.direction.right?i.x=t.x-this.opts.pspace:i.x=t.x,i.y=t.y-Math.ceil(this.opts.pspace/2),i},get_min_size:function(){var e=this.jm.mind.nodes,t=null,i=null;for(var n in e)t=e[n],(i=this.get_node_point_out(t)).x>this.bounds.e&&(this.bounds.e=i.x),i.x<this.bounds.w&&(this.bounds.w=i.x);return{w:this.bounds.e-this.bounds.w,h:this.bounds.s-this.bounds.n}},toggle_node:function(e){e.isroot||(e.expanded?this.collapse_node(e):this.expand_node(e))},expand_node:function(e){e.expanded=!0,this.part_layout(e),this.set_visible(e.children,!0),this.jm.invoke_event_handle(l.event_type.show,{evt:"expand_node",data:[],node:e.id})},collapse_node:function(e){e.expanded=!1,this.part_layout(e),this.set_visible(e.children,!1),this.jm.invoke_event_handle(l.event_type.show,{evt:"collapse_node",data:[],node:e.id})},expand_all:function(){var e,t=this.jm.mind.nodes,i=0;for(var n in t)(e=t[n]).expanded||(e.expanded=!0,i++);if(i>0){var o=this.jm.mind.root;this.part_layout(o),this.set_visible(o.children,!0)}},collapse_all:function(){var e,t=this.jm.mind.nodes,i=0;for(var n in t)(e=t[n]).expanded&&!e.isroot&&(e.expanded=!1,i++);if(i>0){var o=this.jm.mind.root;this.part_layout(o),this.set_visible(o.children,!0)}},expand_to_depth:function(e,t,i){if(!(e<1))for(var n=t||this.jm.mind.root.children,o=i||1,a=n.length,s=null;a--;)s=n[a],o<e&&(s.expanded||this.expand_node(s),this.expand_to_depth(e,s.children,o+1)),o==e&&s.expanded&&this.collapse_node(s)},part_layout:function(e){var t=this.jm.mind.root;if(t){var i=t._data.layout;e.isroot?(i.outer_height_right=this._layout_offset_subnodes_height(i.right_nodes),i.outer_height_left=this._layout_offset_subnodes_height(i.left_nodes)):e._data.layout.direction==l.direction.right?i.outer_height_right=this._layout_offset_subnodes_height(i.right_nodes):i.outer_height_left=this._layout_offset_subnodes_height(i.left_nodes),this.bounds.s=Math.max(i.outer_height_left,i.outer_height_right),this.cache_valid=!1}else n.warn("can not found root node")},set_visible:function(e,t){for(var i=e.length,n=null;i--;)(n=e[i])._data.layout,n.expanded?this.set_visible(n.children,t):this.set_visible(n.children,!1),n.isroot||(n._data.layout.visible=t)},is_expand:function(e){return e.expanded},is_visible:function(e){var t=e._data.layout;return!("visible"in t&&!t.visible)}},l.graph_canvas=function(e){this.opts=e.opts,this.e_canvas=a("canvas"),this.e_canvas.className="jsmind",this.canvas_ctx=this.e_canvas.getContext("2d"),this.size={w:0,h:0}},l.graph_canvas.prototype={element:function(){return this.e_canvas},set_size:function(e,t){this.size.w=e,this.size.h=t,this.e_canvas.width=e,this.e_canvas.height=t},clear:function(){this.canvas_ctx.clearRect(0,0,this.size.w,this.size.h)},draw_line:function(e,t,i){var n=this.canvas_ctx;n.strokeStyle=this.opts.line_color,n.lineWidth=this.opts.line_width,n.lineCap="round",this._fillet_line_to(n,t.x+i.x,t.y+i.y,e.x+i.x,e.y+i.y)},copy_to:function(e,t){e.drawImage(this.e_canvas,0,0),t&&t()},_fillet_line_to:function(e,t,i,n,o){e.beginPath(),e.moveTo(t,i);let a=t<n?-5:5;e.arcTo(n,i,n+a,o,5),e.lineTo(n,o),e.stroke()},_bezier_to:function(e,t,i,n,o){e.beginPath(),e.moveTo(t,i),e.bezierCurveTo(t+2*(n-t)/3,i,t,o,n,o),e.stroke()},_line_to:function(e,t,i,n,o){e.beginPath(),e.moveTo(t,i),e.lineTo(n,o),e.stroke()}},l.graph_svg=function(e){this.view=e,this.opts=e.opts,this.e_svg=l.graph_svg.c("svg"),this.e_svg.setAttribute("class","jsmind"),this.size={w:0,h:0},this.lines=[]},l.graph_svg.c=function(e){return o.createElementNS("http://www.w3.org/2000/svg",e)},l.graph_svg.prototype={element:function(){return this.e_svg},set_size:function(e,t){this.size.w=e,this.size.h=t,this.e_svg.setAttribute("width",e),this.e_svg.setAttribute("height",t)},clear:function(){for(var e=this.lines.length;e--;)this.e_svg.removeChild(this.lines[e]);this.lines.length=0},draw_line:function(e,t,i){var n=l.graph_svg.c("path");n.setAttribute("stroke",this.opts.line_color),n.setAttribute("stroke-width",this.opts.line_width),n.setAttribute("fill","transparent"),this.lines.push(n),this.e_svg.appendChild(n),this._bezier_to(n,t.x+i.x,t.y+i.y,e.x+i.x,e.y+i.y)},copy_to:function(e,t){var i=new Image;i.onload=function(){e.drawImage(i,0,0),t&&t()},i.src="data:image/svg+xml;base64,"+btoa((new XMLSerializer).serializeToString(this.e_svg))},_bezier_to:function(e,t,i,n,o){e.setAttribute("d","M"+t+" "+i+" C "+(t+2*(n-t)/3)+" "+i+", "+t+" "+o+", "+n+" "+o)},_line_to:function(e,t,i,n,o){e.setAttribute("d","M "+t+" "+i+" L "+n+" "+o)}},l.view_provider=function(e,t){this.opts=t,this.jm=e,this.layout=e.layout,this.container=null,this.e_panel=null,this.e_nodes=null,this.size={w:0,h:0},this.selected_node=null,this.editing_node=null,this.graph=null},l.view_provider.prototype={init:function(){var e,t;if(n.debug("view.init"),this.container=(t=this.opts.container)&&"object"==typeof t&&1===t.nodeType&&"object"==typeof t.style&&"object"==typeof t.ownerDocument?this.opts.container:(e=this.opts.container,o.getElementById(e)),this.container){this.e_panel=a("div"),this.e_nodes=a("jmnodes"),this.e_editor=a("input"),this.graph="svg"===this.opts.engine.toLowerCase()?new l.graph_svg(this):new l.graph_canvas(this),this.e_panel.className="jsmind-inner",this.e_panel.tabIndex=1,this.e_panel.appendChild(this.graph.element()),this.e_panel.appendChild(this.e_nodes),this.e_editor.className="jsmind-editor",this.e_editor.type="text",this.actualZoom=1,this.zoomStep=.1,this.minZoom=.5,this.maxZoom=2;var i=this;l.util.dom.add_event(this.e_editor,"keydown",(function(e){var t=e||event;13==t.keyCode&&(i.edit_node_end(),t.stopPropagation())})),l.util.dom.add_event(this.e_editor,"blur",(function(e){i.edit_node_end()})),this.container.appendChild(this.e_panel),this.dragging_enabled=!0,this.draggable_canvas()}else n.error("the options.view.container was not be found in dom")},add_event:function(e,t,i){l.util.dom.add_event(this.e_nodes,t,(function(t){var n=t||event;i.call(e,n)}))},get_binded_nodeid:function(e){if(null==e)return null;var t=e.tagName.toLowerCase();return"jmnodes"==t||"body"==t||"html"==t?null:"jmnode"==t||"jmexpander"==t?e.getAttribute("nodeid"):this.get_binded_nodeid(e.parentElement)},is_expander:function(e){return"jmexpander"==e.tagName.toLowerCase()},reset:function(){n.debug("view.reset"),this.selected_node=null,this.clear_lines(),this.clear_nodes(),this.reset_theme()},reset_theme:function(){var e=this.jm.options.theme;this.e_nodes.className=e?"theme-"+e:""},reset_custom_style:function(){var e=this.jm.mind.nodes;for(var t in e)this.reset_node_custom_style(e[t])},load:function(){n.debug("view.load"),this.init_nodes()},expand_size:function(){var e=this.layout.get_min_size(),t=e.w+2*this.opts.hmargin,i=e.h+2*this.opts.vmargin,n=this.e_panel.clientWidth,o=this.e_panel.clientHeight;n<t&&(n=t),o<i&&(o=i),this.size.w=n,this.size.h=o},init_nodes_size:function(e){var t=e._data.view;t.width=t.element.clientWidth,t.height=t.element.clientHeight},init_nodes:function(){var e=this.jm.mind.nodes,t=o.createDocumentFragment();for(var i in e)this.create_node_element(e[i],t);for(var i in this.e_nodes.appendChild(t),e)this.init_nodes_size(e[i])},add_node:function(e){this.create_node_element(e,this.e_nodes),this.init_nodes_size(e)},create_node_element:function(e,t){var i=null;"view"in e._data?i=e._data.view:(i={},e._data.view=i);var n=a("jmnode");if(e.isroot)n.className="root";else{var o=a("jmexpander");s(o,"-"),o.setAttribute("nodeid",e.id),o.style.visibility="hidden",t.appendChild(o),i.expander=o}e.topic&&(this.opts.support_html?d(n,e.topic):s(n,e.topic)),n.setAttribute("nodeid",e.id),n.style.visibility="hidden",this._reset_node_custom_style(n,e.data),t.appendChild(n),i.element=n},remove_node:function(e){null!=this.selected_node&&this.selected_node.id==e.id&&(this.selected_node=null),null!=this.editing_node&&this.editing_node.id==e.id&&(e._data.view.element.removeChild(this.e_editor),this.editing_node=null);for(var t=e.children,i=t.length;i--;)this.remove_node(t[i]);if(e._data.view){var n=e._data.view.element,o=e._data.view.expander;this.e_nodes.removeChild(n),this.e_nodes.removeChild(o),e._data.view.element=null,e._data.view.expander=null}},update_node:function(e){var t=e._data.view,i=t.element;if(e.topic&&(this.opts.support_html?d(i,e.topic):s(i,e.topic)),this.layout.is_visible(e))t.width=i.clientWidth,t.height=i.clientHeight;else{let e=i.getAttribute("style");i.style="visibility: visible; left:0; top:0;",t.width=i.clientWidth,t.height=i.clientHeight,i.style=e}},select_node:function(e){this.selected_node&&(this.selected_node._data.view.element.className=this.selected_node._data.view.element.className.replace(/\s*selected\b/i,""),this.reset_node_custom_style(this.selected_node)),e&&(this.selected_node=e,e._data.view.element.className+=" selected",this.clear_node_custom_style(e))},select_clear:function(){this.select_node(null)},get_editing_node:function(){return this.editing_node},is_editing:function(){return!!this.editing_node},edit_node_begin:function(e){if(e.topic){null!=this.editing_node&&this.edit_node_end(),this.editing_node=e;var t=e._data.view.element,i=e.topic,o=getComputedStyle(t);this.e_editor.value=i,this.e_editor.style.width=t.clientWidth-parseInt(o.getPropertyValue("padding-left"))-parseInt(o.getPropertyValue("padding-right"))+"px",t.innerHTML="",t.appendChild(this.e_editor),t.style.zIndex=5,this.e_editor.focus(),this.e_editor.select()}else n.warn("don't edit image nodes")},edit_node_end:function(){if(null!=this.editing_node){var e=this.editing_node;this.editing_node=null;var t=e._data.view.element,i=this.e_editor.value;t.style.zIndex="auto",t.removeChild(this.e_editor),l.util.text.is_empty(i)||e.topic===i?this.opts.support_html?d(t,e.topic):s(t,e.topic):this.jm.update_node(e.id,i)}this.e_panel.focus()},get_view_offset:function(){var e=this.layout.bounds;return{x:(this.size.w-e.e-e.w)/2,y:this.size.h/2}},resize:function(){this.graph.set_size(1,1),this.e_nodes.style.width="1px",this.e_nodes.style.height="1px",this.expand_size(),this._show()},_show:function(){this.graph.set_size(this.size.w,this.size.h),this.e_nodes.style.width=this.size.w+"px",this.e_nodes.style.height=this.size.h+"px",this.show_nodes(),this.show_lines(),this.jm.invoke_event_handle(l.event_type.resize,{data:[]})},zoomIn:function(){return this.setZoom(this.actualZoom+this.zoomStep)},zoomOut:function(){return this.setZoom(this.actualZoom-this.zoomStep)},setZoom:function(e){if(e<this.minZoom||e>this.maxZoom)return!1;this.actualZoom=e;for(var t=0;t<this.e_panel.children.length;t++)this.e_panel.children[t].style.zoom=e;return this.show(!0),!0},_center_root:function(){var e=this.e_panel.clientWidth,t=this.e_panel.clientHeight;if(this.size.w>e){var i=this.get_view_offset();this.e_panel.scrollLeft=i.x-e/2}this.size.h>t&&(this.e_panel.scrollTop=(this.size.h-t)/2)},show:function(e){n.debug("view.show"),this.expand_size(),this._show(),e&&this._center_root()},relayout:function(){this.expand_size(),this._show()},save_location:function(e){var t=e._data.view;t._saved_location={x:parseInt(t.element.style.left)-this.e_panel.scrollLeft,y:parseInt(t.element.style.top)-this.e_panel.scrollTop}},restore_location:function(e){var t=e._data.view;this.e_panel.scrollLeft=parseInt(t.element.style.left)-t._saved_location.x,this.e_panel.scrollTop=parseInt(t.element.style.top)-t._saved_location.y},clear_nodes:function(){var e=this.jm.mind;if(null!=e){var t=e.nodes,i=null;for(var n in t)(i=t[n])._data.view.element=null,i._data.view.expander=null;this.e_nodes.innerHTML=""}},show_nodes:function(){var e=this.jm.mind.nodes,t=null,i=null,n=null,o=null,a=null,d="-",r=null,l=this.get_view_offset();for(var h in e)i=(r=(t=e[h])._data.view).element,n=r.expander,this.layout.is_visible(t)?(this.reset_node_custom_style(t),o=this.layout.get_node_point(t),r.abs_x=l.x+o.x,r.abs_y=l.y+o.y,i.style.left=l.x+o.x+"px",i.style.top=l.y+o.y+"px",i.style.display="",i.style.visibility="visible",!t.isroot&&t.children.length>0&&(d=t.expanded?"-":"+",a=this.layout.get_expander_point(t),n.style.left=l.x+a.x+"px",n.style.top=l.y+a.y+"px",n.style.display="",n.style.visibility="visible",s(n,d)),t.isroot||0!=t.children.length||(n.style.display="none",n.style.visibility="hidden")):(i.style.display="none",n.style.display="none")},reset_node_custom_style:function(e){this._reset_node_custom_style(e._data.view.element,e.data)},_reset_node_custom_style:function(e,t){if("background-color"in t&&(e.style.backgroundColor=t["background-color"]),"foreground-color"in t&&(e.style.color=t["foreground-color"]),"width"in t&&(e.style.width=t.width+"px"),"height"in t&&(e.style.height=t.height+"px"),"font-size"in t&&(e.style.fontSize=t["font-size"]+"px"),"font-weight"in t&&(e.style.fontWeight=t["font-weight"]),"font-style"in t&&(e.style.fontStyle=t["font-style"]),"background-image"in t){var i=t["background-image"];if(i.startsWith("data")&&t.width&&t.height){var n=new Image;n.onload=function(){var t=a("canvas");t.width=e.clientWidth,t.height=e.clientHeight;if(t.getContext){t.getContext("2d").drawImage(this,2,2,e.clientWidth,e.clientHeight);var i=t.toDataURL();e.style.backgroundImage="url("+i+")"}},n.src=i}else e.style.backgroundImage="url("+i+")";e.style.backgroundSize="99%","background-rotation"in t&&(e.style.transform="rotate("+t["background-rotation"]+"deg)")}},clear_node_custom_style:function(e){var t=e._data.view.element;t.style.backgroundColor="",t.style.color=""},clear_lines:function(){this.graph.clear()},show_lines:function(){this.clear_lines();var e=this.jm.mind.nodes,t=null,i=null,n=null,o=this.get_view_offset();for(var a in e)(t=e[a]).isroot||"visible"in t._data.layout&&!t._data.layout.visible||(i=this.layout.get_node_point_in(t),n=this.layout.get_node_point_out(t.parent),this.graph.draw_line(n,i,o))},draggable_canvas:function(){if(this.opts.draggable){let e,t,i=!1;this.opts.hide_scrollbars_when_draggable&&(this.e_panel.style="overflow: hidden"),l.util.dom.add_event(this.container,"mousedown",n=>{i=!0,e=n.clientX,t=n.clientY}),l.util.dom.add_event(this.container,"mouseup",()=>{i=!1}),l.util.dom.add_event(this.container,"mousemove",n=>{this.dragging_enabled&&i&&(this.e_panel.scrollBy(e-n.clientX,t-n.clientY),e=n.clientX,t=n.clientY)})}},get_draggable_canvas:function(){return this.opts.draggable},enable_draggable_canvas:function(){this.dragging_enabled=!0},disable_draggable_canvas:function(){this.dragging_enabled=!1}},l.shortcut_provider=function(e,t){this.jm=e,this.opts=t,this.mapping=t.mapping,this.handles=t.handles,this._newid=null,this._mapping={}},l.shortcut_provider.prototype={init:function(){for(var e in l.util.dom.add_event(this.jm.view.e_panel,"keydown",this.handler.bind(this)),this.handles.addchild=this.handle_addchild,this.handles.addbrother=this.handle_addbrother,this.handles.editnode=this.handle_editnode,this.handles.delnode=this.handle_delnode,this.handles.toggle=this.handle_toggle,this.handles.up=this.handle_up,this.handles.down=this.handle_down,this.handles.left=this.handle_left,this.handles.right=this.handle_right,this.mapping)this.mapping[e]&&e in this.handles&&(this._mapping[this.mapping[e]]=this.handles[e]);"function"==typeof this.opts.id_generator?this._newid=this.opts.id_generator:this._newid=l.util.uuid.newid},enable_shortcut:function(){this.opts.enable=!0},disable_shortcut:function(){this.opts.enable=!1},handler:function(e){if(9==e.which&&e.preventDefault(),!this.jm.view.is_editing()){var t=e||event;if(!this.opts.enable)return!0;var i=t.keyCode+(t.metaKey<<13)+(t.ctrlKey<<12)+(t.altKey<<11)+(t.shiftKey<<10);i in this._mapping&&this._mapping[i].call(this,this.jm,e)}},handle_addchild:function(e,t){var i=e.get_selected_node();if(i){var n=this._newid();e.add_node(i,n,"New Node")&&(e.select_node(n),e.begin_edit(n))}},handle_addbrother:function(e,t){var i=e.get_selected_node();if(i&&!i.isroot){var n=this._newid();e.insert_node_after(i,n,"New Node")&&(e.select_node(n),e.begin_edit(n))}},handle_editnode:function(e,t){var i=e.get_selected_node();i&&e.begin_edit(i)},handle_delnode:function(e,t){var i=e.get_selected_node();i&&!i.isroot&&(e.select_node(i.parent),e.remove_node(i))},handle_toggle:function(e,t){var i=t||event,n=e.get_selected_node();n&&(e.toggle_node(n.id),i.stopPropagation(),i.preventDefault())},handle_up:function(e,t){var i=t||event,n=e.get_selected_node();if(n){var o=e.find_node_before(n);if(!o){var a=e.find_node_before(n.parent);a&&a.children.length>0&&(o=a.children[a.children.length-1])}o&&e.select_node(o),i.stopPropagation(),i.preventDefault()}},handle_down:function(e,t){var i=t||event,n=e.get_selected_node();if(n){var o=e.find_node_after(n);if(!o){var a=e.find_node_after(n.parent);a&&a.children.length>0&&(o=a.children[0])}o&&e.select_node(o),i.stopPropagation(),i.preventDefault()}},handle_left:function(e,t){this._handle_direction(e,t,l.direction.left)},handle_right:function(e,t){this._handle_direction(e,t,l.direction.right)},_handle_direction:function(e,t,i){var n=t||event,o=e.get_selected_node(),a=null;if(o){if(o.isroot){for(var s=o.children,d=[],r=0;r<s.length;r++)s[r].direction===i&&d.push(r);a=s[d[Math.floor((d.length-1)/2)]]}else if(o.direction===i){var l=(d=o.children).length;l>0&&(a=d[Math.floor((l-1)/2)])}else a=o.parent;a&&e.select_node(a),n.stopPropagation(),n.preventDefault()}}},l.plugin=function(e,t){this.name=e,this.init=t},l.plugins=[],l.register_plugin=function(e){e instanceof l.plugin&&l.plugins.push(e)},l.init_plugins=function(e){t.setTimeout((function(){l._init_plugins(e)}),0)},l._init_plugins=function(e){for(var t=l.plugins.length,i=null,n=0;n<t;n++)"function"==typeof(i=l.plugins[n].init)&&i(e)},l.show=function(e,t,i){var n=new l(e);return n.show(t),n},e.exports=l}else n.log("jsMind has been already exist.")}("undefined"!=typeof window?window:global)},778:function(e,t,i){!function(t,i){var n=null,o=t.jsMind,a=t.document,s=function(e){return a.createElement(e)},d=function(){},r="undefined"==typeof console?{log:d,debug:d,error:d,warn:d,info:d}:console;if(o&&!o.menu){o.menu=function(e){n=this,this._get_menu_options(e,(function(){this.init(e),this._mount_events()}))},o.menu.prototype={defaultDataMap:{funcMap:{edit:{isDepNode:!0,defaultFn:function(e){this._menu_default_mind_methods._menu_begin_edit.call(this.jm)&&this._menu_default_mind_methods._menu_edit_node_begin(this.jm.view,e)},fn:d,text:"edit node"},addChild:{isDepNode:!0,fn:function(e,t){var i=this.get_selected_node();i&&(this.add_node(i,e,t)&&(this.select_node(e),this.begin_edit(e),n._mount_events()))},text:"append child"},addBrother:{isDepNode:!0,fn:function(e,t){var i=this.get_selected_node();i&&!i.isroot&&(this.insert_node_after(i,e,t)&&(this.select_node(e),this.begin_edit(e),n._mount_events()))},text:"append brother"},delete:{isDepNode:!0,fn:function(){this.shortcut.handle_delnode.call(this.shortcut,this)},text:"delete node"},showAll:{sDepNode:!1,fn:function(){this.expand_all(this)},text:"show all"},hideAll:{isDepNode:!1,fn:function(){this.collapse_all(this)},text:"hide all"},screenshot:{isDepNode:!1,fn:function(){this.screenshot?this.screenshot.shootDownload():r.error("[jsmind] screenshot dependent on jsmind.screenshot.js !")},text:"load mind picture"},showNode:{isDepNode:!0,fn:function(e){this.expand_node(e)},text:"show target node"},hideNode:{isDepNode:!0,fn:function(e){this.collapse_node(e)},text:"hide target node"}},menuStl:{width:"150px",padding:"12px 0",position:"fixed","z-index":"10",background:"#fff","box-shadow":"0 2px 12px 0 rgba(0,0,0,0.1)","border-radius":"5px","font-size":"12px",display:"none","transfORM-origin":"0 0"},menuItemStl:{padding:"5px 15px",cursor:"pointer",display:"block","text-align":"center",transition:"all .2s"},injectionList:["edit","addChild","delete"]},init:function(e){this._create_menu(e),this._get_injectionList(e),this.menuOpts.switchMidStage&&o.util.dom.add_event(e.view.e_editor,"blur",function(){this._menu_default_mind_methods._menu_edit_node_end.call(e.view),"function"!=typeof this.menuOpts.editCaller?this._menu_default_mind_methods._menu_update_edit_node():this.menuOpts.editCaller(t.menu._update_node_info,this._menu_default_mind_methods._menu_update_edit_node)}.bind(this))},_event_contextMenu(e){e.preventDefault(),this.menu.style.left=e.clientX+"px",this.menu.style.top=e.clientY+"px",this.menu.style.display="block",this.selected_node=this.jm.get_selected_node()},_event_hideMenu(){this.menu.style.display="none"},_mount_events(){var e=document.getElementsByTagName("jmnode");for(let t=0;t<e.length;t++)e[t].oncontextmenu=this._event_contextMenu.bind(this);t.onclick=this._event_hideMenu.bind(this)},_create_menu(e){var t=s("menu");this._set_menu_wrap_syl(t),this.menu=t,this.e_panel=e.view.e_panel,this.e_panel.appendChild(t)},_create_menu_item(e,t,i,n,a,r){var l=s("menu-item"),h=this;return this._set_menu_item_syl(l),l.innerText=t,l.addEventListener("click",function(){if(this.selected_node||!n)return r.call(h,this.selected_node),h._get_mid_opts()?void a(this.selected_node,h._mid_stage_next(function(){var t=[this.selected_node],n=Array.prototype.slice.call(arguments[0],0);n[1]=this.menuOpts.newNodeText||"New Node",n[0]&&(t=n),i.apply(e,t)}.bind(this))):(a(this.selected_node,d),void i.call(e,o.util.uuid.newid(),this.menuOpts.newNodeText||"New Node"));alert(this.menuOpts.tipContent||"Continue with node selected！")}.bind(this)),l.addEventListener("mouseover",function(){l.style.background="#f0f9eb"}.bind(this)),l.addEventListener("mouseleave",function(){l.style.background="#fff"}.bind(this)),l},_set_menu_wrap_syl(e){var t=this._get_option_sty("menu",this._get_mixin_sty);e.style.cssText=this._format_cssText(t)},_set_menu_item_syl(e){var t=this._get_option_sty("menuItem",this._get_mixin_sty);e.style.cssText=this._format_cssText(t)},_format_cssText(e){var t="";return Object.keys(e).forEach((function(i){t+=i+":"+e[i]+";"})),t},_empty_object:e=>0==Object.keys(e).length,_get_option_sty(e,t){var i=this.menuOpts.style,n={menu:this.defaultDataMap.menuStl,menuItem:this.defaultDataMap.menuItemStl};return i&&i[e]?!i[e]||this._empty_object(i[e])?n[e]:t(n[e],i[e]):n[e]},_get_mixin_sty(e,t){var i={};return Object.keys(t).forEach((function(e){i[e]=t[e]})),Object.keys(e).forEach((function(t){i[t]||(i[t]=e[t])})),i},_get_menu_options(e,t){var i=e.options;i.menuOpts&&i.menuOpts.showMenu&&(this.menuOpts=e.options.menuOpts,t.call(this))},_get_injectionDetail(){var e=this.menuOpts.injectionList,t=this.defaultDataMap.injectionList;return e?Array.isArray(e)?0==e.length?t:e:void r.error("[jsmind] injectionList must be a Array"):t},_get_injectionList(e){var t=this._get_injectionDetail(),i=this;t.forEach((function(t){var n=null,o="",a=d,s=d;"object"==typeof t?(n=i.defaultDataMap.funcMap[t.target],o=t.text,t.callback&&(a=t.callback)):o=(n=i.defaultDataMap.funcMap[t]).text,n.defaultFn&&(s=n.defaultFn),i.menu.appendChild(i._create_menu_item(e,o,n.fn,n.isDepNode,a,s))}))},_get_mid_opts(){var e=this.menuOpts.switchMidStage;return!!e&&("boolean"!=typeof e?(r.error("[jsmind] switchMidStage must be Boolean"),!1):e)},_switch_view_db_event(){o.prototype.dblclick_handle=d,o.shortcut_provider.prototype.handler=d,o.view_provider.prototype.edit_node_end=d},_mid_stage_next:e=>function(){e(arguments)},_reset_mind_event_edit(){},_menu_default_mind_methods:{_menu_begin_edit:function(){var e=this.get_editable();return e||r.error("fail, this mind map is not editable."),e},_menu_edit_node_begin(e,t){if(t.topic){null!=e.editing_node&&this._menu_default_mind_methods._menu_edit_node_end.call(e),e.editing_node=t;var i=t._data.view.element,n=t.topic,o=getComputedStyle(i);e.e_editor.value=n,e.e_editor.style.width=i.clientWidth-parseInt(o.getPropertyValue("padding-left"))-parseInt(o.getPropertyValue("padding-right"))+"px",i.innerHTML="",i.appendChild(e.e_editor),i.style.zIndex=5,e.e_editor.focus(),e.e_editor.select()}else r.warn("don't edit image nodes")},_menu_edit_node_end:function(){if(null!=this.editing_node){var e=this.editing_node;this.editing_node=null;var i=e._data.view.element,n=this.e_editor.value;i.style.zIndex="auto",i.removeChild(this.e_editor),t.menu._update_node_info={id:e.id,topic:n},(o.util.text.is_empty(n)||e.topic===n)&&(this.opts.support_html?(s=i,(d=e.topic)instanceof HTMLElement?(d.innerHTML="",s.appendChild(d)):s.innerHTML=d):function(e,t){e.hasChildNodes()?e.firstChild.nodeValue=t:e.appendChild(a.createTextNode(t))}(i,e.topic))}var s,d},_menu_update_edit_node:function(){var e=t.menu._update_node_info;t.menu.jm.update_node(e.id,e.topic)}}};var l=new o.plugin("menu",(function(e){t.menu=new o.menu(e),t.menu.jm=e,t.menu.menuOpts&&(e.menu=t.menu)}));o.register_plugin(l),o.preventMindEventDefault=function(){o.menu.prototype._switch_view_db_event()},e.exports={reBuild:function(){null!==n&&n._mount_events()},init:function(e){o=e}}}}(window)},779:function(e,t){
/**
 * @license BSD
 * @copyright 2014-2022 hizzgdev@163.com
 * 
 * Project Home:
 *   https://github.com/hizzgdev/jsmind/
 */
!function(e){"use strict";var t=e.jsMind;if(t&&void 0===t.screenshot){var i=e.document,n=function(e){return i.createElement(e)},o=function(e,t){return e.getPropertyValue(t)},a=function(e){var t=o(e,"visibility"),i=o(e,"display");return"hidden"!==t&&"none"!==i},s={rect:function(e,t,i,n,o,a){n<2*a&&(a=n/2),o<2*a&&(a=o/2),e.moveTo(t+a,i),e.arcTo(t+n,i,t+n,i+o,a),e.arcTo(t+n,i+o,t,i+o,a),e.arcTo(t,i+o,t,i,a),e.arcTo(t,i,t+n,i,a)},text_multiline:function(e,t,i,n,o,a,s){var d="",r=t.length,l=t.split(""),h=null;e.textAlign="left",e.textBaseline="top";for(var _=0;_<r;_++)h=d+l[_],e.measureText(h).width>o&&_>0?(e.fillText(d,i,n),d=l[_],n+=s):d=h;e.fillText(d,i,n)},text_ellipsis:function(e,t,i,n,o,a){var d=n+a/2;t=s.fittingString(e,t,o);e.textAlign="left",e.textBaseline="middle",e.fillText(t,i,d,o)},fittingString:function(e,t,i){var n=e.measureText(t).width,o=e.measureText("…").width;if(n<=i||n<=o)return t;for(var a=t.length;n>=i-o&&a-- >0;)t=t.substring(0,a),n=e.measureText(t).width;return t+"…"},image:function(e,t,i,n,o,a,d,r,l){var h=new Image;h.onload=function(){e.save(),e.translate(i,n),e.save(),e.beginPath(),s.rect(e,0,0,o,a,d),e.closePath(),e.clip(),e.translate(o/2,a/2),e.rotate(r*Math.PI/180),e.drawImage(h,-o/2,-a/2),e.restore(),e.restore(),l&&l()},h.src=t}};t.screenshot=function(e){this.jm=e,this.canvas_elem=null,this.canvas_ctx=null,this._inited=!1},t.screenshot.prototype={init:function(){if(!this._inited){console.log("init");var e=n("canvas"),t=e.getContext("2d");this.canvas_elem=e,this.canvas_ctx=t,this.jm.view.e_panel.appendChild(e),this._inited=!0,this.resize()}},shoot:function(e){this.init(),this._draw(function(){e&&e(),this.clean()}.bind(this)),this._watermark()},shootDownload:function(){this.shoot(function(){this._download()}.bind(this))},shootAsDataURL:function(e){this.shoot(function(){e&&e(this.canvas_elem.toDataURL())}.bind(this))},resize:function(){this._inited&&(this.canvas_elem.width=this.jm.view.size.w,this.canvas_elem.height=this.jm.view.size.h)},clean:function(){var e=this.canvas_elem;this.canvas_ctx.clearRect(0,0,e.width,e.height)},_draw:function(e){var t=this.canvas_ctx;t.textAlign="left",t.textBaseline="top",this._draw_lines(function(){this._draw_nodes(e)}.bind(this))},_watermark:function(){var t=this.canvas_elem,i=this.canvas_ctx;i.textAlign="right",i.textBaseline="bottom",i.fillStyle="#000",i.font="11px Verdana,Arial,Helvetica,sans-serif",i.fillText("hizzgdev.github.io/jsmind",t.width-5.5,t.height-2.5),i.textAlign="left",i.fillText(e.location,5.5,t.height-2.5)},_draw_lines:function(e){this.jm.view.graph.copy_to(this.canvas_ctx,e)},_draw_nodes:function(t){var i,n=this.jm.mind.nodes;for(var o in n)i=n[o],this._draw_node(i);!function o(){console.log("check_node_ready"+new Date);var a=!0;for(var s in n)a&=(i=n[s]).ready;a?e.setTimeout(t,200):e.setTimeout(o,200)}()},_draw_node:function(e){var t=this.canvas_ctx,i=e._data.view,n=i.element,d=getComputedStyle(n);if(a(d)){var r=o(d,"background-color"),l=parseInt(o(d,"border-top-left-radius")),h=o(d,"color"),_=parseInt(o(d,"padding-left")),c=parseInt(o(d,"padding-right")),u=parseInt(o(d,"padding-top")),f=parseInt(o(d,"padding-bottom")),v=o(d,"text-overflow"),p=o(d,"font-style")+" "+o(d,"font-variant")+" "+o(d,"font-weight")+" "+o(d,"font-size")+"/"+o(d,"line-height")+" "+o(d,"font-family"),m={x:i.abs_x,y:i.abs_y,w:i.width+1,h:i.height+1},g={x:m.x+_,y:m.y+u,w:m.w-_-c,h:m.h-u-f};if(t.font=p,t.fillStyle=r,t.beginPath(),s.rect(t,m.x,m.y,m.w,m.h,l),t.closePath(),t.fill(),t.fillStyle=h,"background-image"in e.data){var y=o(d,"background-image").slice(5,-2);e.ready=!1;var w=0;"background-rotation"in e.data&&(w=e.data["background-rotation"]),s.image(t,y,m.x,m.y,m.w,m.h,l,w,(function(){e.ready=!0}))}if(e.topic)if("ellipsis"===v)s.text_ellipsis(t,e.topic,g.x,g.y,g.w,g.h);else{var b=parseInt(o(d,"line-height"));s.text_multiline(t,e.topic,g.x,g.y,g.w,g.h,b)}i.expander&&this._draw_expander(i.expander),"background-image"in e.data||(e.ready=!0)}else e.ready=!0},_draw_expander:function(e){var t=this.canvas_ctx,i=getComputedStyle(e);if(a(i)){var n=o(i,"left"),s=o(i,"top"),d=(o(i,"font"),parseInt(n)),r=parseInt(s),l="+"===e.innerHTML;t.lineWidth=1,t.beginPath(),t.arc(d+7,r+7,5,0,2*Math.PI,!0),t.moveTo(d+10,r+7),t.lineTo(d+4,r+7),l&&(t.moveTo(d+7,r+4),t.lineTo(d+7,r+10)),t.closePath(),t.stroke()}},_download:function(){var e=this.canvas_elem,t=this.jm.mind.name+".png";if(navigator.msSaveBlob&&e.msToBlob){var o=e.msToBlob();navigator.msSaveBlob(o,t)}else{var a=this.canvas_elem.toDataURL(),s=n("a");if("download"in s){s.style.visibility="hidden",s.href=a,s.download=t,i.body.appendChild(s);var d=i.createEvent("MouseEvents");d.initEvent("click",!0,!0),s.dispatchEvent(d),i.body.removeChild(s)}else location.href=a}},jm_event_handle:function(e,i){e===t.event_type.resize&&this.resize()}};var d=new t.plugin("screenshot",(function(e){var i=new t.screenshot(e);e.screenshot=i,e.shoot=function(){i.shoot()},e.add_event_listener((function(e,t){i.jm_event_handle.call(i,e,t)}))}));t.register_plugin(d)}}(window)},780:function(e,t,i){"use strict";i(716)},781:function(e,t,i){"use strict";i(717)},782:function(e,t,i){"use strict";i(718)},843:function(e,t,i){"use strict";i.r(t);i(776);var n=i(777),o=i.n(n),a=i(744);window.jsMind=o.a;const{init:s,reBuild:d}=i(778);i(715),i(779),s(o.a);let r=null;var l={name:"xMind",props:{showBar:{type:Boolean,default:!0},isEdit:{type:Boolean,default:!0}},components:{useXmindCom:a.default},data:()=>({mind:{},jm:null,isZoomIn:!1,isZoomOut:!1,level:0,win:null,fileName:"",isShowXmindDoc:!1,nodeOptions:[{value:1,label:"展开到一级节点"},{value:2,label:"展开到二级节点"},{value:3,label:"展开到三级节点"},{value:4,label:"展开到四级节点"},{value:0,label:"展开全部节点"},{value:-1,label:"隐藏全部节点"}],themeOptions:[{value:"default",label:"default"},{value:"primary",label:"primary"},{value:"warning",label:"warning"},{value:"danger",label:"danger"},{value:"success",label:"success"},{value:"info",label:"info"},{value:"greensea",label:"greensea"},{value:"nephrite",label:"nephrite"},{value:"belizehole",label:"belizehole"},{value:"wisteria",label:"wisteria"},{value:"asphalt",label:"asphalt"},{value:"orange",label:"orange"},{value:"pumpkin",label:"pumpkin"},{value:"pomegranate",label:"pomegranate"},{value:"clouds",label:"clouds"},{value:"asbestos",label:"asbestos"}],theme:"success",dialogVisible:!1,addDefaultMind:{meta:{name:"思维导图",author:"作者",version:"版本"},format:"node_array",data:[{id:"root",topic:"Root Node",expanded:!0,isroot:!0}]}}),created(){},mounted(){this.win=window,console.log(this.win),document.getElementById("jsmind_container").addEventListener("contextmenu",(function(e){e.preventDefault()})),this.getData()},watch:{"jm.mind":{handler(){const e=this.jm.get_data("node_array"),t=o.a.util.json.json2string(e);d(),this.writeLocalFile(t)},deep:!0}},methods:{hXind(){this.isShowXmindDoc=!1},async uploadFile(){try{let[e]=await this.win.showOpenFilePicker({types:[{description:"",accept:{"application/json":[".jm"]}}],excludeAcceptAllOption:!0,multiple:!1});if(!e)return;if(r=e,"directory"===r.kind)return void this.$message.warning("请选择文件");let t=await r.getFile();this.jsmind(t)}catch(e){if(console.log(e),e.toString().includes("aborted"))return;this.$message.warning("你的浏览器可能不支持，建议使用最新版本的Chrome浏览器")}},jsmind(e,t){o.a.util.file.read(e,i=>{let n="";try{n=o.a.util.json.string2json(i)}catch{this.$message.error("导入文件格式出错！")}if(n){this.fileName=e.name.slice(0,-3);try{if(this.jm.show(n),d(),t)return!1;this.readFile()}catch{this.$message.error("导入文件出错！")}}})},getData(){this.mind={meta:{name:"思维导图",author:"作者",version:"版本"},format:"node_array",data:[{id:"root",topic:"<<书名>>",expanded:!0,isroot:!0},{id:"90c71d924f1adea9",topic:"人物介绍",expanded:!0,parentid:"root",direction:"right"},{id:"90c839e938bf71db",topic:"主角",expanded:!0,parentid:"90c71d924f1adea9"},{id:"90c83b742f006735",topic:"配角",expanded:!0,parentid:"90c71d924f1adea9"},{id:"90c841f5229f028a",topic:"地图/势力",expanded:!0,parentid:"root",direction:"right"},{id:"90c84bc9f74ef755",topic:"修炼体系",expanded:!0,parentid:"root",direction:"right"},{id:"90c7215ddd822523",topic:"小说主线一",expanded:!0,parentid:"root",direction:"right"},{id:"90c72864525a64c1",topic:"支线一",expanded:!0,parentid:"90c7215ddd822523"},{id:"90c8257c74084c2c",topic:"故事线一",expanded:!0,parentid:"90c72864525a64c1"},{id:"90c8285b0fde42ac",topic:"故事线二",expanded:!0,parentid:"90c72864525a64c1"},{id:"90c7340d3fd79ee3",topic:"支线二",expanded:!0,parentid:"90c7215ddd822523"},{id:"90c734f62dbdf94e",topic:"支线三",expanded:!0,parentid:"90c7215ddd822523"}]},this.open_empty()},open_empty(){const e={container:"jsmind_container",editable:!0,theme:this.theme,view:{line_width:2,line_color:"skyblue",draggable:!0,hide_scrollbars_when_draggable:!0},shortcut:{enable:!0,mapping:{addchild:9,addbrother:13,editnode:113,delnode:8,toggle:32,left:37,up:38,right:39,down:40}},mode:"side",menuOpts:{showMenu:!0,injectionList:[{target:"edit",text:"编辑节点"},{target:"delete",text:"删除节点"},{target:"addChild",text:"添加子节点"},{target:"addBrother",text:"添加兄弟节点"}],style:{menuItem:{"line-height":"28px"}}}};this.jm=o.a.show(e,this.mind),window.onresize=()=>{this.jm.resize()}},async writeLocalFile(e){if(!r)return;console.log(e),console.log(r);const t=await r.createWritable();await t.write(e),await t.close()},async readFile(e){let t=await r.getFile();console.log(t);let i=new FileReader;this.fileName=t.name.slice(0,-3),i.onload=async()=>{this.$notify({title:`当前正在编辑你本机的${t.name}文件`,message:"在网文助手编辑本地文件，会自动保存更改内容，刷新页面需要重新导入该文件。",duration:5e3})},i.readAsText(t),1==e&&this.jsmind(t,e)},async createLocalFile(e,t,i,n){try{let o=await this.win.showSaveFilePicker({types:[{description:"",accept:{"application/json":[".jm"]}}],suggestedName:t});if(!o)return;const a=this.$loading({lock:!0,text:`文件${i}中...`,spinner:"el-icon-loading",background:"rgba(245, 248, 243, 0.8)"});r=o,await this.writeLocalFile(e);let s=1==n?1:"";await this.readFile(s),a.close(),this.$message.success(`文件${i}成功！`)}catch(e){if(console.log(e),e.toString().includes("aborted"))return;this.$message.warning("你的浏览器可能不支持，建议使用最新版本的Chrome浏览器")}},save_nodearray_file(e,t){if(2==e&&""==this.fileName)return this.$message.error("请输入文件名称！"),!1;const i=this.jm.get_data("node_array"),n=this.fileName,a=2==e?o.a.util.json.json2string(i):o.a.util.json.json2string(this.addDefaultMind);this.createLocalFile(a,n,t,e)},screen_shot(){this.jm.screenshot.shootDownload()},expand_all(){this.jm.expand_all()},collapse_all(){this.jm.collapse_all()},expand_to_level(e){switch(e){case-1:this.collapse_all();break;case 0:this.expand_all();break;default:this.jm.expand_to_depth(e)}},zoomIn(){this.jm.view.zoomIn()?this.isZoomOut=!1:this.isZoomIn=!0},zoomOut(){this.jm.view.zoomOut()?this.isZoomIn=!1:this.isZoomOut=!0},prompt_info(e){alert(e)},get_nodearray_data(){const e=this.jm.get_data("node_array"),t=o.a.util.json.json2string(e);console.log(t),this.prompt_info(t)},set_theme(e){this.jm.set_theme(e)},scrollFunc(e){(e=e||this.win.event).wheelDelta?e.wheelDelta>0?this.zoomIn():this.zoomOut():e.detail&&(e.detail>0?this.zoomIn():this.zoomOut()),this.jm.resize()},mouseWheel(){document.addEventListener&&document.addEventListener("domMouseScroll",this.scrollFunc,!1),this.$refs.container.onmousewheel=this.scrollFunc},hJumpMd(){this.isShowXmindDoc=!0}},beforeDestroy(){document.removeEventListener("domMouseScroll",this.scrollFunc,!1)}},h=(i(780),i(781),i(782),i(46)),_=Object(h.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"content_write"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isShowXmindDoc,expression:"!isShowXmindDoc"}],staticClass:"tipContent"},[t("div",{staticClass:"jsmind_layout"},[e.showBar?t("div",{staticClass:"jsmind_toolbar"},[t("span",{staticStyle:{display:"flex","flex-wrap":"wrap"}},[t("el-button",{attrs:{type:"success",size:"medium"},on:{click:e.uploadFile}},[e._v("导入")]),e._v(" "),t("el-button",{attrs:{size:"medium",type:"success"},on:{click:function(t){return e.save_nodearray_file(1,"新建")}}},[e._v("新建")]),e._v(" "),t("el-button",{attrs:{size:"medium",type:"success"},on:{click:function(t){return e.save_nodearray_file(2,"保存")}}},[e._v("另存为")]),e._v(" "),t("el-button",{staticClass:"savePic",attrs:{size:"medium",type:"success"},on:{click:e.screen_shot}},[e._v("截图")]),e._v(" "),t("el-button",{staticClass:"getData",attrs:{size:"medium",type:"success"},on:{click:e.get_nodearray_data}},[e._v("获取数据")])],1),e._v(" "),t("span",{staticStyle:{display:"flex","flex-wrap":"wrap","justify-content":"flex-start","margin-left":"10px","margin-top":"10px"}},[t("span",{staticClass:"pad-left tit"},[e._v("展开关闭：")]),e._v(" "),t("el-select",{staticClass:"pad pad-left",attrs:{placeholder:"展开节点"},on:{change:e.expand_to_level},model:{value:e.level,callback:function(t){e.level=t},expression:"level"}},e._l(e.nodeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),e._v(" "),t("span",{staticClass:"tit"},[e._v("设置主题：")]),e._v(" "),t("el-select",{staticClass:"setType",attrs:{placeholder:"选择主题"},on:{change:e.set_theme},model:{value:e.theme,callback:function(t){e.theme=t},expression:"theme"}},e._l(e.themeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),e._v(" "),t("span",{staticClass:"tit",staticStyle:{"margin-left":"10px"}},[e._v("文件名称：")]),e._v(" "),t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入文件名称"},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}})],1)]):e._e(),e._v(" "),t("div",{ref:"container",attrs:{id:"jsmind_container"}},[t("div",{staticClass:"zoom_in_out"},[t("el-tooltip",{attrs:{effect:"dark",content:"点击学习工具使用！",placement:"top-start"}},[t("span",{staticClass:"useSty",on:{click:e.hJumpMd}},[e._v("详")])]),e._v(" "),t("span",[t("i",{staticClass:"zoom-icon el-icon-plus",class:!0===e.isZoomIn?"disabled":"",on:{click:e.zoomIn}})]),e._v(" "),t("span",[t("i",{staticClass:"zoom-icon el-icon-minus",class:!0===e.isZoomOut?"disabled":"",on:{click:e.zoomOut}})])],1)])])]),e._v(" "),t("useXmindCom",{directives:[{name:"show",rawName:"v-show",value:e.isShowXmindDoc,expression:"isShowXmindDoc"}],on:{change:e.hXind}})],1)}),[],!1,null,"e72e7f44",null);t.default=_.exports}}]);